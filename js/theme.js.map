{"version":3,"file":"theme.js","sources":["../src/js/events.js","../src/js/menu-button-new.js","../src/js/colorscheme.js","../src/js/share-popups.js"],"sourcesContent":["/**\n * Emit a custom event\n * @param  {String} type   The event type\n * @param  {Object} detail Any details to pass along with the event\n * @param  {Node}   elem   The element to attach the event to\n */\nfunction emitEvent (type, detail = {}, elem = document) {\n\t// Make sure there's an event type\n\tif (!type) return;\n\n\t// Create a new event\n\tlet event = new CustomEvent(type, {\n\t\tbubbles: true,\n\t\tcancelable: true,\n\t\tdetail: detail\n\t});\n\n\t// Dispatch the event\n\treturn elem.dispatchEvent(event);\n}\n\nexport default emitEvent;\n","import emitEvent from './events.js';\n\nfunction isPrintableChar (str) {\n\treturn str.length === 1 && str.match(/\\S/);\n}\n\n// TODO - test (natch), add hover/click focus classes\n/**\n * For WP Nav items, use:\n * let itemSelector = '.menu-item a';\n *\n * For all focusable elements, use:\n * let itemSelector = [\n * \t'a[href]:not([tabindex^=\"-\"])',\n * \t'area[href]:not([tabindex^=\"-\"])',\n * \t'input:not([type=\"hidden\"]):not([type=\"radio\"]):not([disabled]):not([tabindex^=\"-\"])',\n * \t'input[type=\"radio\"]:not([disabled]):not([tabindex^=\"-\"])',\n * \t'select:not([disabled]):not([tabindex^=\"-\"])',\n * \t'textarea:not([disabled]):not([tabindex^=\"-\"])',\n * \t'Toggle:not([disabled]):not([tabindex^=\"-\"])',\n * \t'iframe:not([tabindex^=\"-\"])',\n * \t'audio[controls]:not([tabindex^=\"-\"])',\n * \t'video[controls]:not([tabindex^=\"-\"])',\n * \t'[contenteditable]:not([tabindex^=\"-\"])',\n * \t'[tabindex]:not([tabindex^=\"-\"])'\n * ].join(',');\n */\nfunction MenuToggle (toggle, itemSelector = 'a', options = {}) {\n\tif (!toggle) return;\n\tif (!(toggle instanceof Element)) {\n\t\tthrow new Error(\"No toggle element passed in.\");\n\t}\n\n\tlet menuId = toggle.getAttribute('data-expand');\n\tif (!menuId) return;\n\n\tlet menu = document.getElementById(menuId);\n\tif (!menu) return;\n\n\tlet settings = Object.assign({\n\t\tsetMaxHeight: false,\n\t\tsetAriaHidden: true,\n\t\tonOutsideClick: false,\n\t\tshiftFocus: true,\n\t\taccordion: false\n\t}, options);\n\tObject.freeze(settings);\n\n\tthis.toggle = toggle;\n\tthis.menuId = menuId;\n\tthis.menu = menu;\n\tthis.parent = toggle.closest('[data-expand-parent]');\n\tthis.settings = settings;\n\tthis.expanded = menu.getAttribute('data-expand-open') ? true : false;\n\tthis.firstMenuItem = false;\n\tthis.lastMenuItem = false;\n\tthis.currentMenuItem = false;\n\tthis.firstChars = [];\n\tthis.menuItems = [];\n\n\tthis.expand = this.expand.bind(this);\n\tthis.collapse = this.collapse.bind(this);\n\tthis.setFocusToItem = this.setFocusToItem.bind(this);\n\tthis.setFocusToFirstItem = this.setFocusToFirstItem.bind(this);\n\tthis.setFocusToLastItem = this.setFocusToLastItem.bind(this);\n\tthis.setFocusToPrevItem = this.setFocusToPrevItem.bind(this);\n\tthis.setFocusToNextItem = this.setFocusToNextItem.bind(this);\n\tthis.setFocusByFirstChar = this.setFocusByFirstChar.bind(this);\n\tthis.onOutsideClick = this.onOutsideClick.bind(this);\n\tthis.onToggleClick = this.onToggleClick.bind(this);\n\tthis.onToggleKeydown = this.onToggleKeydown.bind(this);\n\tthis.onMenuKeydown = this.onMenuKeydown.bind(this);\n\n\tlet menuItems = menu.querySelectorAll(itemSelector);\n\tif (menuItems.length) {\n\t\tfor (let menuItem of menuItems) {\n\t\t\tthis.menuItems.push(menuItem);\n\t\t\tmenuItem.tabIndex = -1;\n\t\t\tthis.firstChars.push(menuItem.textContent.trim()[0].toLowerCase());\n\t\t\tif (!this.firstMenuItem) this.firstMenuItem = menuItem;\n\t\t\tthis.lastMenuItem = menuItem;\n\t\t}\n\t}\n\n\tthis.toggle.setAttribute('aria-controls', this.menuId);\n\tthis.menu.hasAttribute('aria-labelledby') || this.menu.setAttribute('aria-label', this.toggle.innerText);\n\n\tif (this.expanded) {\n\t\tthis.expand();\n\n\t} else {\n\t\tthis.collapse();\n\t}\n\n\tthis.toggle.addEventListener('click', this.onToggleClick, false);\n\tthis.toggle.addEventListener('keydown', this.onToggleKeydown, false);\n\n\tif (this.parent && this.settings.onOutsideClick) {\n\t\tdocument.addEventListener('click', this.onOutsideClick, false);\n\t}\n\n\temitEvent('MenuToggle:ready', {\n\t\tMenuToggle: this,\n\t\texpanded: this.expanded\n\t});\n}\n\nMenuToggle.prototype.expand = function () {\n\tthis.toggle.setAttribute('aria-expanded', 'true');\n\tif (this.parent) this.parent.setAttribute('aria-expanded', 'true');\n\tif (this.settings.setAriaHidden) this.menu.removeAttribute('aria-hidden');\n\tif (this.settings.setMaxHeight) this.menu.style.maxHeight = this.menu.scrollHeight + \"px\";\n\tthis.expanded = true;\n\tthis.menu.addEventListener('keydown', this.onMenuKeydown, false);\n\tthis.menu.addEventListener('focusin', this.onFocusin, false);\n\tthis.menu.addEventListener('focusout', this.onFocusout, false);\n\tthis.menu.addEventListener('mouseOver', this.onMenuMouseover, false);\n\temitEvent('MenuToggle:expand', {\n\t\tMenuToggle: this,\n\t\texpanded: this.expanded\n\t});\n\treturn this;\n}\n\nMenuToggle.prototype.collapse = function () {\n\tthis.toggle.setAttribute('aria-expanded', 'false');\n\tthis.expanded = false;\n\tthis.currentMenuItem = false;\n\tif (this.parent) this.parent.setAttribute('aria-expanded', 'false');\n\tif (this.settings.setAriaHidden) this.menu.setAttribute('aria-hidden', '');\n\tif (this.settings.setMaxHeight) this.menu.style.maxHeight = null;\n\tthis.menu.removeEventListener('keydown', this.onMenuKeydown, false);\n\tthis.menu.removeEventListener('focusin', this.onFocusin, false);\n\tthis.menu.removeEventListener('focusout', this.onFocusout, false);\n\tthis.menu.removeEventListener('mouseOver', this.onMenuMouseover, false);\n\temitEvent('MenuToggle:collapse', {\n\t\tMenuToggle: this,\n\t\texpanded: this.expanded\n\t});\n\treturn this;\n}\n\nMenuToggle.prototype.setFocusToItem = function (item) {\n\tfor (let menuItem of this.menuItems) {\n\t\tif (item === menuItem) {\n\t\t\tmenuItem.tabIndex = 0;\n\t\t\tmenuItem.focus();\n\t\t\tthis.currentMenuItem = menuItem;\n\t\t} else {\n\t\t\tmenuItem.tabIndex = -1;\n\t\t}\n\t}\n}\n\nMenuToggle.prototype.setFocusToFirstItem = function () {\n\tthis.setFocusToItem(this.firstMenuItem);\n}\n\nMenuToggle.prototype.setFocusToLastItem = function () {\n\tthis.setFocusToItem(this.LastMenuItem);\n}\n\nMenuToggle.prototype.setFocusToPrevItem = function () {\n\tif (!this.currentMenuItem) return;\n\tlet prev, index;\n\tif (this.currentMenuItem === this.firstMenuItem) {\n\t\tprev = this.lastMenuItem;\n\t} else {\n\t\tindex = this.menuItems.indexOf(this.currentMenuItem);\n\t\tprev = this.menuItems[index - 1];\n\t}\n\tthis.setFocusToItem(prev);\n}\n\nMenuToggle.prototype.setFocusToNextItem = function () {\n\tif (!this.currentMenuItem) return;\n\tlet next, index;\n\tif (this.currentMenuItem === this.lastMenuItem) {\n\t\tnext = this.firstMenuItem;\n\t} else {\n\t\tindex = this.menuItems.indexOf(this.currentMenuItem);\n\t\tnext = this.menuItems[index + 1];\n\t}\n\tthis.setFocusToItem(next);\n}\n\nMenuToggle.prototype.setFocusByFirstChar = function (char) {\n\tif (char.length > 1) return;\n\tchar = char.toLowerCase();\n\tlet start = this.menuItems.indexOf(this.currentMenuItem) + 1;\n\tlet index = this.firstChars.indexOf(char, start);\n\tindex = index === -1 ? this.firstChars.indexOf(char, 0) : index;\n\tif (index > -1) this.setFocusToMenuItem(this.menuItems[index]);\n}\n\nMenuToggle.prototype.onOutsideClick = function (event) {\n\tif (this.menu.contains(event.target) || !this.expanded) return;\n\tthis.collapse();\n\treturn this;\n}\n\nMenuToggle.prototype.onToggleKeydown = function (event) {\n\tlet key = event.key,\n\t\tflag = false;\n\n\tswitch (key) {\n\t\tcase ' ':\n\t\tcase 'Enter':\n\t\tcase 'ArrowDown':\n\t\tcase 'Down':\n\t\t\tthis.expand();\n\t\t\tthis.setFocusToFirstItem();\n\t\t\tflag = true;\n\t\t\tbreak;\n\n\t\tcase 'Esc':\n\t\tcase 'Escape':\n\t\t\tthis.collapse();\n\t\t\tthis.toggle.focus();\n\t\t\tflag = true;\n\t\t\tbreak;\n\n\t\tcase 'Up':\n\t\tcase 'ArrowUp':\n\t\t\tthis.expand();\n\t\t\tthis.setFocusToLastItem();\n\t\t\tflag = true;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\tif (flag) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n}\n\nMenuToggle.prototype.onFocusin = function (event) {\n\tlet a = event.target.closest('a');\n\tif (!a) return;\n\ta.classList.add('focus');\n}\n\nMenuToggle.prototype.onFocusout = function (event) {\n\tlet a = event.target.closest('a');\n\tif (!a) return;\n\ta.classList.remove('focus');\n}\n\nMenuToggle.prototype.onToggleClick = function (event) {\n\tif (this.expanded) {\n\t\tthis.collapse();\n\t\tthis.toggle.focus();\n\n\t} else {\n\t\tthis.expand();\n\t\tthis.setFocusToFirstItem();\n\t}\n\n\tevent.stopPropagation();\n\tevent.preventDefault();\n}\n\nMenuToggle.prototype.onMenuMouseover = function (event) {\n\tlet a = event.target.closest('a');\n\tif (!a) return;\n\ta.focus();\n}\n\nMenuToggle.prototype.onMenuKeydown = function (event) {\n\tif (!this.menu.contains(event.target)) return;\n\tlet tgt = event.currentTarget,\n\t\tkey = event.key,\n\t\tflag = false;\n\n\tif (event.ctrlKey || event.altKey || event.metaKey) {\n\t\treturn;\n\t}\n\n\tif (event.shiftKey) {\n\t\tif (isPrintableChar(key)) {\n\t\t\tthis.setFocusByFirstChar(tgt, key);\n\t\t\tflag = true;\n\t\t}\n\n\t\tif (key === 'Tab') {\n\t\t\tthis.toggleEl.focus();\n\t\t\tthis.collapse();\n\t\t\tflag = true;\n\t\t}\n\n\t} else {\n\t\tswitch (key) {\n\t\t\tcase ' ':\n\t\t\t\twindow.location.href = tgt.href;\n\t\t\t\tbreak;\n\n\t\t\tcase 'Esc':\n\t\t\tcase 'Escape':\n\t\t\t\tthis.collapse();\n\t\t\t\tthis.toggleEl.focus();\n\t\t\t\tflag = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 'Up':\n\t\t\tcase 'ArrowUp':\n\t\t\t\tthis.setFocusToPrevItem(tgt);\n\t\t\t\tflag = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ArrowDown':\n\t\t\tcase 'Down':\n\t\t\t\tthis.setFocusToNextItem(tgt);\n\t\t\t\tflag = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 'Home':\n\t\t\tcase 'PageUp':\n\t\t\t\tthis.setFocusToFirstItem();\n\t\t\t\tflag = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 'End':\n\t\t\tcase 'PageDown':\n\t\t\t\tthis.setFocusToLastItem();\n\t\t\t\tflag = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 'Tab':\n\t\t\t\tthis.collapse();\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tif (isPrintableChar(key)) {\n\t\t\t\t\tthis.setFocusByFirstChar(tgt, key);\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (flag) {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\temitEvent('MenuToggle:menuKeydown', {\n\t\tMenuToggle: this\n\t});\n}\n\nfunction initToggles () {\n\tlet toggles = document.querySelectorAll('[data-expand]');\n\tif (!toggles.length) return;\n\tfor (let toggle of toggles) {\n\t\tnew MenuToggle(toggle);\n\t}\n}\n\ndocument.addEventListener('DOMContentLoaded', initToggles, false);\n\nexport {MenuToggle as default};\n","( function() {\n\tlet btn = document.querySelector('[data-toggle-color-scheme]');\n\tif (!btn) return;\n\tlet prefersDark = window.matchMedia('(prefers-color-scheme: dark)');\n\tlet localScheme = localStorage.getItem('color-scheme');\n\tlet scheme = document.body.getAttribute('data-color-scheme');\n\tscheme = scheme ? scheme : 'light';\n\tif (localScheme) {\n\t\tscheme = localScheme;\n\n\t} else if (prefersDark.matches) {\n\t\tscheme = 'dark';\n\t}\n\tbtn.setAttribute('data-toggle-color-scheme', scheme);\n\tdocument.body.setAttribute('data-color-scheme', scheme);\n\n\tfunction toggleScheme (event) {\n\t\tlet btn = event.target.closest('[data-toggle-color-scheme]');\n\t\tif (!btn) return;\n\t\tif (scheme === 'dark') {\n\t\t\tscheme = 'light';\n\t\t} else {\n\t\t\tscheme = 'dark';\n\t\t}\n\t\tbtn.setAttribute('data-toggle-color-scheme', scheme);\n\t\tdocument.body.setAttribute('data-color-scheme', scheme);\n\t\tlocalStorage.setItem('color-scheme', scheme);\n\t}\n\tdocument.addEventListener('click', toggleScheme, false);\n} )();\n","/**\n * Opens share links in new popup window\n */\nfunction sharePopups() {\n\tconst links = document.querySelectorAll('.share-link:not(.share-link-email)');\n\tif (!links.length) return;\n\n\tfunction popup(event) {\n\t\tif (!event.target.closest('.share-link:not(.share-link-email)')) return;\n\t\tconst url = this.href;\n\t\tif (!/^(f|ht)tps?:\\/\\//i.test(url) && !/^mailto/i.test(url)) return;\n\t\tevent.preventDefault();\n\t\tconst w = 500;\n\t\tconst h = 300;\n\t\tconst left = ( screen.width / 2 ) - ( w / 2 );\n\t\tconst top = ( screen.height / 2 ) - ( h / 2 );\n\t\twindow.open(\n\t\t\turl,\n\t\t\t'',\n\t\t\t'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width=' + w + ',height=' + h + ',top=' + top + ',left=' + left\n\t\t);\n\n\t}\n\n\tdocument.addEventListener('click', popup, false);\n}\n\ndocument.addEventListener('DOMContentLoaded', sharePopups, false);\n\n"],"names":["emitEvent","type","detail","elem","document","event","CustomEvent","bubbles","cancelable","dispatchEvent","isPrintableChar","str","length","match","MenuToggle","toggle","itemSelector","options","Element","Error","menuId","getAttribute","menu","getElementById","settings","Object","assign","setMaxHeight","setAriaHidden","onOutsideClick","shiftFocus","accordion","freeze","this","parent","closest","expanded","firstMenuItem","lastMenuItem","currentMenuItem","firstChars","menuItems","expand","bind","collapse","setFocusToItem","setFocusToFirstItem","setFocusToLastItem","setFocusToPrevItem","setFocusToNextItem","setFocusByFirstChar","onToggleClick","onToggleKeydown","onMenuKeydown","querySelectorAll","menuItem","push","tabIndex","textContent","trim","toLowerCase","setAttribute","hasAttribute","innerText","addEventListener","prototype","removeAttribute","style","maxHeight","scrollHeight","onFocusin","onFocusout","onMenuMouseover","removeEventListener","item","focus","LastMenuItem","prev","index","indexOf","next","char","start","setFocusToMenuItem","contains","target","flag","key","stopPropagation","preventDefault","a","classList","add","remove","tgt","currentTarget","ctrlKey","altKey","metaKey","shiftKey","toggleEl","window","location","href","toggles","btn","querySelector","prefersDark","matchMedia","localScheme","localStorage","getItem","scheme","body","matches","setItem","url","test","left","screen","width","top","height","open"],"mappings":"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"}